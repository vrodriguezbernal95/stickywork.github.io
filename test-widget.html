<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Widget - Peluquer√≠a Prueba</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .status {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status p {
            margin: 8px 0;
        }
        .status strong {
            color: #3b82f6;
        }
        #stickywork-container {
            margin-top: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .console-log {
            background: #1a1a1a;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .console-log div {
            margin: 3px 0;
        }
    </style>
</head>
<body>
    <h1>üß™ Test de Integraci√≥n del Widget StickyWork</h1>

    <div class="status">
        <p><strong>Estado:</strong> <span id="status">Inicializando...</span></p>
        <p><strong>Business ID:</strong> 10 (Peluquer√≠a Prueba)</p>
        <p><strong>Modo:</strong> Embedded</p>
        <p><strong>API URL:</strong> https://api.stickywork.com</p>
        <p><strong>Widget URL:</strong> https://stickywork.com/widget/stickywork-widget.js</p>
    </div>

    <!-- Contenedor del widget -->
    <div id="stickywork-widget"></div>

    <!-- Console log visual -->
    <div class="console-log" id="console-log">
        <div>üì¶ Cargando widget...</div>
    </div>

    <!-- Script del widget -->
    <script src="https://stickywork.com/widget/stickywork-widget.js"></script>
    <script>
        // Guardar referencias originales PRIMERO
        const originalLog = console.log;
        const originalError = console.error;

        // Funci√≥n para agregar logs visualmente
        function addLog(message, color = '#0f0') {
            const logDiv = document.getElementById('console-log');
            const div = document.createElement('div');
            div.textContent = message;
            div.style.color = color;
            logDiv.appendChild(div);
            logDiv.scrollTop = logDiv.scrollHeight;
            // Usar originalLog para evitar recursi√≥n infinita
            originalLog.call(console, message);
        }

        // Interceptar console.log
        console.log = function(...args) {
            addLog(args.join(' '));
        };

        // Interceptar console.error
        console.error = function(...args) {
            addLog('‚ùå ' + args.join(' '), '#f00');
        };

        addLog('üì¶ Iniciando carga del widget...');

        // Verificar que el script se carg√≥
        if (typeof StickyWork !== 'undefined') {
            addLog('‚úÖ Script del widget cargado correctamente');
            document.getElementById('status').textContent = 'Widget cargado';
            document.getElementById('status').style.color = 'green';
        } else {
            addLog('‚ùå Error: StickyWork no est√° definido', '#f00');
            document.getElementById('status').textContent = 'Error al cargar widget';
            document.getElementById('status').style.color = 'red';
        }

        // Configurar eventos de consola para detectar errores
        window.addEventListener('error', function(e) {
            addLog('‚ùå Error detectado: ' + e.message, '#f00');
            document.getElementById('status').textContent = 'Error: ' + e.message;
            document.getElementById('status').style.color = 'red';
        });

        // Inicializar el widget
        try {
            addLog('üîß Inicializando widget con:');
            addLog('  - businessId: 10');
            addLog('  - mode: embedded');
            addLog('  - apiUrl: https://api.stickywork.com');

            StickyWork.init({
                businessId: 10,
                mode: 'embedded',
                apiUrl: 'https://api.stickywork.com'
            });

            addLog('‚úÖ Widget inicializado correctamente');

            // Esperar un poco y verificar que se renderiz√≥
            setTimeout(() => {
                const container = document.getElementById('stickywork-widget');
                if (container && container.children.length > 0) {
                    addLog('‚úÖ CHECKLIST ITEM 2: WIDGET SE INTEGRA - COMPLETADO');
                    document.getElementById('status').textContent = 'Widget integrado correctamente ‚úÖ';
                    document.getElementById('status').style.color = 'green';
                } else {
                    addLog('‚ö†Ô∏è Widget inicializado pero el contenedor est√° vac√≠o', '#ff0');
                    addLog('‚ö†Ô∏è Verificando que el widget tenga servicios configurados...', '#ff0');
                }
            }, 3000);

        } catch (error) {
            addLog('‚ùå Error al inicializar widget: ' + error.message, '#f00');
            document.getElementById('status').textContent = 'Error: ' + error.message;
            document.getElementById('status').style.color = 'red';
        }
    </script>
</body>
</html>
